<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title>Create a Serverless API with Fastify Framework · Hexoder</title><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="Create a Serverless API with Fastify Framework - M ABD AZIZ ALFIAN"><meta name="keywords" content="learning-javascript, tutorial-javascript, learning-nodejs, tutorial-nodejs"><meta name="author" content="M ABD AZIZ ALFIAN"><link rel="short icon" href="/images/favicon.ico"><link rel="stylesheet" href="//cdn.jsdelivr.net/gh/aalfiann/hexoder@gh-pages/css/bubuzou.min.css"><link rel="search" type="application/opensearchdescription+xml" href="https://hexoder.com/atom.xml" title="Hexoder"><script src="//cdn.jsdelivr.net/npm/text-obfuscator@1.0.2/dist/text-obfuscator.min.js"></script><script>function parse_query_string(e){for(var o=e.replace("?","").split("&"),n={},r=0;r<o.length;r++){var t=o[r].split("="),i=decodeURIComponent(t[0]),a=decodeURIComponent(t[1]);if(void 0===n[i])n[i]=decodeURIComponent(a);else if("string"==typeof n[i]){var l=[n[i],decodeURIComponent(a)];n[i]=l}else n[i].push(decodeURIComponent(a))}return n}function removeParam(e,o){var n=o.split("?")[0],r=[],t=-1!==o.indexOf("?")?o.split("?")[1]:"";if(""!==t){for(var i=(r=t.split("&")).length-1;0<=i;i-=1)r[i].split("=")[0]===e&&r.splice(i,1);0<r.length?n=n+"?"+r.join("&"):n+=r.join("&")}return n}var hash=parse_query_string(window.location.search).to;if(hash){var link=TextObfuscator.decode(hash,3),newurl=removeParam("to",window.location.href);newurl=newurl.replace(window.location.origin,""),window.history.replaceState({},document.title,newurl)}</script><script data-ad-client="ca-pub-8811888720849913" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script></head><body><header><div class="header row"><a class="logo-link" href="/"><img src="//cdn.jsdelivr.net/gh/aalfiann/hexoder@gh-pages/images/logo-landscape.png"></a><ul class="nav nav-list" id="nav_list"><li class="nav-list-item"><a class="nav-list-link" href="/" target="_self" data-hover="HOME">HOME</a></li><li class="nav-list-item"><a class="nav-list-link" href="/about" target="_self" data-hover="ABOUT">ABOUT</a></li><li class="nav-list-item"><a class="nav-list-link" href="/archives/" target="_self" data-hover="ARCHIVES">ARCHIVES</a></li><li class="nav-list-item"><a class="nav-list-link" href="/contact" target="_self" data-hover="CONTACT">CONTACT</a></li></ul><div class="search"><a id="search_btn" href="#search"></a></div><div class="nav-btn" id="nav_btn"><span></span><span></span><span></span></div></div></header><div class="row scroll-con"><section class="container"><div id="safelinker1"></div><div class="post" id="postAr"><article class="post-block"><h1 class="post-title">Create a Serverless API with Fastify Framework</h1><div class="post-info">2020-01-14</div><div class="post-content"><p><img src="https://i.imgur.com/RUGHGxf.jpg" alt=""></p><p>Hello guys, today I will write a tutorial about create serverless API with Fastify framework. Serverless means you don’t need a NodeJS server to run. Are you sure? NodeJS is a platform to run JavaScript on the server side, but how we can make it serverless? If you want to know more detail? Just check this out.</p><a id="more"></a><h2 id="What-is-Serverless-API"><a href="#What-is-Serverless-API" class="headerlink" title="What is Serverless API ?"></a>What is Serverless API ?</h2><p>Serverless API is an API which is running your core application without a http server. So there is no http server in your API application. Everything is run by event driven in server machine. Serverless are most used in cloud systems server.</p><h2 id="Benefit-Serverless"><a href="#Benefit-Serverless" class="headerlink" title="Benefit Serverless"></a>Benefit Serverless</h2><p>Actualy there are more benefits to use serverless, but these three points is very useful benefit to use serverless for your project.</p><ol><li><p>Eficient Cost<br>Serverless is more cost-effective because you only pay as you go. You don’t need to buy fixed cost for the machine server.</p></li><li><p>Handled by Cloud<br>There is no server in your API application, so everything is handled by cloud vendors.</p></li><li><p>Event Triggered<br>Because serverless API is run by event driven, you are able to invoked your function directly without a http server if you are in same microservices environment. This is similar with FaaS (Function as a Service).</p></li></ol><h2 id="Const-of-Serverless"><a href="#Const-of-Serverless" class="headerlink" title="Const of Serverless"></a>Const of Serverless</h2><p>Actualy there is more const of using serverless, but I only describe 3 points which is very important to consider.</p><ol><li><p>Resource limit<br>Serverless is using resource directly with OS of the server machine. Means you are on limit when compute for high task.<br>It is better for you to keep your serverless application always small. But creating a small application doesn’t mean that you can’t scale your serverless application. If you in microservices environment, of course you are able to scale it.</p></li><li><p>Performance<br>Serverless could suffer from response latency. Because serverless will start runtime from the begin for every process so this will always add more latency.</p></li><li><p>Security<br>You can not control the security of serverless. Because serverless is using resources directly from OS. When the OS having vulnerable, it could affect to your serverless application.</p></li></ol><h2 id="Create-Serverless-with-Fastify"><a href="#Create-Serverless-with-Fastify" class="headerlink" title="Create Serverless with Fastify"></a>Create Serverless with Fastify</h2><p>In this article I will use Fastify framework to create a serverless API. Why?</p><ol><li><p>Fastest NodeJS Framework<br>Fastify is the fastest NodeJS Framework today. Fastify still on the top ranking of performance speed or benchmark speed than other well known nodejs framework.</p></li><li><p>Everything is Plugin<br>Fastify using modular architecture concept. So this will easy and fast to develop, because we can work together in parallel.</p></li><li><p>Simple, Flexible and Minimalist<br>Fastify is very simple and easy to learn even you are newbie in NodeJS. Because of minimalist and their simplicity, I feel flexible to choose any library in <code>NPMJS</code>.</p></li></ol><p>So the tutorial to create serverless with Fastify is :</p><h3 id="1-Install-Fastify"><a href="#1-Install-Fastify" class="headerlink" title="1. Install Fastify"></a>1. Install Fastify</h3><p>To install fastify is just run this command below</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install fastify</span><br></pre></td></tr></table></figure><p>If installation process done, you can go to the next step below.</p><h3 id="2-Create-serverless-js"><a href="#2-Create-serverless-js" class="headerlink" title="2. Create serverless.js"></a>2. Create serverless.js</h3><p>Now create <code>serverless.js</code> file in new directory <code>api/</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> build = <span class="built_in">require</span>(<span class="string">'./index'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = build()</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = <span class="keyword">async</span> <span class="function"><span class="keyword">function</span> (<span class="params">req, res</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">await</span> app.ready()</span><br><span class="line">  app.server.emit(<span class="string">'request'</span>, req, res)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-Create-index-js"><a href="#3-Create-index-js" class="headerlink" title="3. Create index.js"></a>3. Create index.js</h3><p>Now create <code>index.js</code> file in same directory <code>api/</code></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">'use strict'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> fastify = <span class="built_in">require</span>(<span class="string">'fastify'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">build</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> app = fastify(&#123;</span><br><span class="line">    logger: <span class="literal">true</span></span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  app.get(<span class="string">'/'</span>, <span class="keyword">async</span> (req, res) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;<span class="attr">statusCode</span>:res.statusCode,<span class="attr">message</span>:<span class="string">'Welcome to my serverless API.'</span>&#125;</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> app</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = build</span><br></pre></td></tr></table></figure><h3 id="4-Create-now-js"><a href="#4-Create-now-js" class="headerlink" title="4. Create now.js"></a>4. Create now.js</h3><p>You have to create <code>now.js</code> file on root of your project. Just copy and paste this code below.</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"version"</span>: <span class="number">2</span>,</span><br><span class="line">  <span class="string">"builds"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"src"</span>: <span class="string">"api/serverless.js"</span>,</span><br><span class="line">      <span class="string">"use"</span>: <span class="string">"@now/node"</span>,</span><br><span class="line">      <span class="string">"config"</span>: &#123;</span><br><span class="line">        <span class="string">"helpers"</span>: <span class="literal">false</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="string">"routes"</span>: [</span><br><span class="line">    &#123; <span class="string">"src"</span>: <span class="string">"/.*"</span>, <span class="string">"dest"</span>: <span class="string">"/api/serverless.js"</span>&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Done, this is very simple right? To add more advanced routes, just see Fastify documentation at <a href="https://www.fastify.io/docs/latest/Routes/" target="_blank" target="_blank" target="_blank" rel="noopener external nofollow noopener noreferrer">here</a>.</p><h2 id="How-to-test"><a href="#How-to-test" class="headerlink" title="How to test ?"></a>How to test ?</h2><p>You can not test your serveless API with HTTP request right now because you need a serveless runtime container service. So the only way to test is, you have to create your own unit test for example with <a href="https://www.npmjs.com/package/mocha" target="_blank" target="_blank" target="_blank" rel="noopener external nofollow noopener noreferrer">mocha</a>.</p><h2 id="How-to-Deploy"><a href="#How-to-Deploy" class="headerlink" title="How to Deploy ?"></a>How to Deploy ?</h2><p>To deploy your first serverless API after following the tutorial above, now follow this steps below:</p><ol><li><p>Create GitHub Account<br>You have to create a Github account at <a href="https://github.com" target="_blank" target="_blank" target="_blank" rel="noopener external nofollow noopener noreferrer">here</a>. If you already have an account in GitHub, just upload your project into your new repository.</p></li><li><p>Create Zeit Now Account.<br>You have to create a Zeit Now account at <a href="https://zeit.co" target="_blank" target="_blank" target="_blank" rel="noopener external nofollow noopener noreferrer">here</a>. If you already have an account in Zeit Now, you can just create new app in Zeit Now, then follow the steps on Zeit Now. It is very easy, no hard configuration and no code required.</p></li></ol><p>Done, your serverless API is will deployed in minutes. No domain required, because Zeit Now will give you free. But you are able to change with your custom domain later.</p><h2 id="How-this-Works"><a href="#How-this-Works" class="headerlink" title="How this Works"></a>How this Works</h2><p>Serverless is event driven concept. So the main point to build a serverless API is you have to create event driven application then create a http route for communication with client request.</p><h2 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h2><p>Fastify framework wasn’t designed for serverless framework, but Fastify has a way for being serverless API. But to run this serverless API you need a hosting provider who provide serverless container service for example <a href="https://zeit.co" target="_blank" target="_blank" target="_blank" rel="noopener external nofollow noopener noreferrer">Zeit Now</a>. Why I choose <code>Zeit Now</code>? Because they very simple to use or to deploy, they have a zero configuration for nodejs and they have a free service. I use they free service to make research before I write this tutorial.</p><p>Actualy I don’t have any affiliate with <code>Zeit Now</code>, Of course you can make serverless API with other hosting provider like <a href="https://cloud.google.com/run" target="_blank" target="_blank" target="_blank" rel="noopener external nofollow noopener noreferrer">Google Cloud Run</a>, <a href="https://aws.amazon.com/lambda" target="_blank" target="_blank" target="_blank" rel="noopener external nofollow noopener noreferrer">AWS Lambda</a>, etc.</p><p>Don’t forget, free service is always have it’s limitation, if you are serious about your business, I recommend you to buy the premium hosting service from them.</p><p>Thank you for your time to reading my article.</p></div></article></div><div id="safelinker2"></div><div class="right-container"><div class="widget"><div id="arAnchorBar"></div></div></div></section></div><div class="right-menu"></div><div class="modal search-modal"><div class="input-field"><input type="text" id="search_input"><label for="search-input">Search</label></div><div class="search-result" id="search_result"></div></div><div class="blog-overlay"></div><footer class="row"><div class="footer-con"><div class="paginator"><a class="prev" href="/post/create-your-own-vanilla-datatables/" title="Create Your Own DataTables">PREV</a><a class="next" href="/post/very-lightweight-form-validation-javascript-library/" title="Very Lightweight Form Validation Javascript Library">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_config=function(){this.page.url=window.location.href,this.page.identifier=window.location.href};!function(){var e=document,t=e.createElement("script");t.src="https://hexoder.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)}()</script><div class="copyright"><p>© 2019 - 2020 <a href="/" target="_blank">Hexoder</a> | <a href="/disclaimer">Disclaimer</a> | <a href="/privacy-policy">Privacy</a> | <a href="/atom.xml">Feed</a> | <a href="/sitemap.xml">Sitemap</a></p><br><a class="dmca-badge" href="//www.dmca.com/Protection/Status.aspx?ID=eb23d7cc-74cc-4a2f-8e4d-d4676a061313" title="DMCA.com Protection Status"><img src="https://images.dmca.com/Badges/dmca_protected_sml_120m.png?ID=eb23d7cc-74cc-4a2f-8e4d-d4676a061313" alt="DMCA.com Protection Status"></a><script src="https://images.dmca.com/Badges/DMCABadgeHelper.min.js"></script></div><div class="totop"><i></i></div></div></footer><script src="//cdn.jsdelivr.net/gh/aalfiann/hexoder@gh-pages/scripts/jquery-1.8.2.min.js"></script><script src="//cdn.jsdelivr.net/gh/aalfiann/hexoder@gh-pages/scripts/ar-anchor.min.js"></script><script src="//cdn.jsdelivr.net/gh/aalfiann/hexoder@gh-pages/scripts/main.js"></script><script src="//cdn.jsdelivr.net/npm/safelink-jquery@1.1.0/src/safelink.min.js"></script><script>$("#safelinker1").Safelink({encoded:link,timer:!0,firstButtonText:"Click Here First >>",secondButtonText:"Continue to Get Link >>"}).build("#safelinker2","btn-safelink btn-hoverable")</script><script>!function(e,a,t,n,g,c){e.GoogleAnalyticsObject=n,e.ga||(e.ga=function(){(e.ga.q=e.ga.q||[]).push(arguments)}),e.ga.l=+new Date,g=a.createElement(t),c=a.getElementsByTagName(t)[0],g.src="//www.google-analytics.com/analytics.js",c.parentNode.insertBefore(g,c)}(window,document,"script","ga"),ga("create","UA-151912342-1","auto"),ga("send","pageview")</script></body></html>